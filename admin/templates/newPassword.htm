<!--
# (C) 2005 The Honeynet Project.  All rights reserved.
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 2
# of the License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA
#
#----- Authors: Scott Buchan <sbuchan@hush.com>

-->
<html>

<script language="javascript">
<!--

function confirmPassword() {

	var password = document.password.newpassword.value;
	var upper = /[A-Z]/;
	var lower = /[a-z]/;
	var num = /\d/;
	var white = /\s/;
	var special = /\W/;
	
	if(white.test(password)) {
		alert("Password must not contain any white spaces.");
		return false;
	}

	if(!upper.test(password)) {
		alert("Password must contain at least 1 upper case letter.");
		return false;
	}

	if(!lower.test(password)) {
		alert("Password must contain at least 1 lower case letter.");
		return false;
	}

	if(!num.test(password)) {
		alert("Password must contain at least 1 digit.");
		return false;
	}

	if(!special.test(password)) {
		alert("Password must contain at least 1 special character (ex: shift 1).");
		return false;
	}


	if (password.length < 8) {
		alert("Password length must be at least 8 characters");
		return false;
	}


	


	if (document.password.newpassword.value != document.password.confirmpassword.value) {
		alert("Your passwords do not match.");
		return false;
	}

	return true;
}

-->
</script>
	


<head>
	<title>Honeywall Change Password</title>
<link rel="stylesheet" href="../walleye.css" type="text/css">
</head>

<body>
<table border="0" cellpadding="0">
	<tr>
		<td>
			<table border="0" class="nav">
				<tr>
					<td class="nav_title" colspan="2"></td>
					<td class="nav_title" colspan="2"><center><h3>Honeywall Change Password</h3></center></td>
					<td class="nav_title" colspan="2"><center>[% date %]</center></td>
					<td></td>
				</tr>
				<tr>
                    <td class="nav_blank" width="150"></td>
                    <td class="nav_blank" width="150"></td>
                    <td/>
                    <td/>
                    <td/>
                    <td ></td>
                </tr>

				<tr>
					<td class="nav_blank"></td>
					<td class="nav_blank"></td>
					<td class="nav_blank"></td>
					<td class="nav_blank"></td>
					<td class="nav_blank"></td>
					<td class="nav_blank"></td>
					<td class="nav_blank"></td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td>
			<table cellspacing="0" cellpadding="15">
				<tr>
					<td>
						<table border="0" cellpadding="3">
							<tr>
								<td align="center">
									<form action="/admin/newPassword.pl" method="post" name="password" onsubmit="return confirmPassword()">
									<table class="summary">
										<tr>
											<td class="sum_h" colspan="4">Change Password (Min 8, 1 upper, 1 lower, 1 number, 1 special)</td>
										</tr>
										<tr>
                               				<td colspan="4">&nbsp;</td> 
                            			</tr>
                            			<tr>
                                			<td>&nbsp;</td>
                                			<td colspan="2">
                                   			The new password must be at least 8 characters and it must
											contain at least 1 upper and 1 lower case character, at 
											least 1 number and at least 1 special character 
											(ex: shift 1). 
			                                </td>
            			                    <td>&nbsp;</td>
                        			    </tr>
			                            <tr>
            			                    <td colspan="4">&nbsp;</td>
                        			    </tr>
										[% IF message != "" %]
										<tr>
											<td colspan="4">&nbsp; [% message %]</td>
										</tr>
										<tr>
											<td colspan="4">&nbsp;</td>
										</tr>
										[% END %]
										<tr>
											<td>&nbsp;</td>
											<td align="right">
												User Name:  
											</td>
											<td align="center">
												<input style="width:150px;" name="userName" value="[% login_name %]" type="text" size="20" maxlength="20">
											</td>
											<td>&nbsp;</td>
										</tr>
										<tr>
											<td>&nbsp;</td>										
											<td align="right">
												Current Password: 
											</td>
											<td align="center">
												<input style="width:150px;" name="password" value="" type="password" size="20" maxlength="20">
											</td>
											<td>&nbsp;</td>											
										</tr>
										<tr>
											<td>&nbsp;</td>										
											<td align="right">
												New Password: 
											</td>
											<td align="center">
												<input style="width:150px;" name="newpassword" value="" type="password" size="20" maxlength="20">
											</td>
											<td>&nbsp;</td>											
										</tr>
										<tr>
											<td>&nbsp;</td>										
											<td align="right">
												Confirm	Password: 
											</td>
											<td align="center">
												<input style="width:150px;" name="confirmpassword" value="" type="password" size="20" maxlength="20">
											</td>
											<td>&nbsp;</td>											
										</tr>

										
										<tr><td colspan="4">&nbsp;</td></tr>
										
										<tr>
											<td>&nbsp;</td>
											<td><input name="login" type="submit" value="Change Password"></td>
											<td colspan="2">&nbsp;</td>											
										</tr>
										<tr><td colspan="4">&nbsp;</td></tr>
										
									</table>
									</form>
								</td>
							</tr>
							<tr>
								<td>
									
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
</body>
</html>
